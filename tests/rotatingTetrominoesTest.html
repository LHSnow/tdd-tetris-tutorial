<!DOCTYPE html>

<!--
  Copyright (c) 2008-2012  Esko Luontola <www.orfjackal.net> and Lars Bergström <harhund.com>
  You may use and modify this source code freely for personal non-commercial use.
  This source code may NOT be used as course material without prior written agreement.

  @author Esko Luontola <www.orfjackal.net> (original Java/junit examples)
  @author Lars Bergström <harhund.com> (adaptation to Javascript/qunit)
-->
 
<html>
<head>
  <meta charset="utf-8">
  <title>Rotating Tetrominoes test</title>
  <link rel="stylesheet" href="http://code.jquery.com/qunit/qunit-1.11.0.css">
</head>
<body>
  <div id="qunit"></div>
  <div id="qunit-fixture"></div>
</body>

<script src="../src/block.js"></script>
<script src="../src/piece.js"></script>
<script src="../src/tetromino.js"></script>
<script src="http://code.jquery.com/qunit/qunit-1.11.0.js"></script>
<script>

var shape;

/*
module("All shape instances", {
  setup: function() {
    shape = new Tetromino("T");
  }
});

test("are immutable", function() {
    var original = shape.toString();
    shape.rotateRight();
    equal(original, shape.toString());
    shape.rotateLeft();
    equal(original, shape.toString());
  }
);
*/

module("The T shape", {
  setup: function() {
      shape = new Tetromino("T");
  }
});

test("is shaped like T", function() {
  equal(shape.toString(), "" +
          ".T.\n" +
          "TTT\n" +
          "...\n");
});

test("can be rotated right 3 times", function() {
  shape = shape.rotateRight();
  equal(shape.toString(), "" +
          ".T.\n" +
          ".TT\n" +
          ".T.\n");
  shape = shape.rotateRight();
  equal(shape.toString(), "" +
          "...\n" +
          "TTT\n" +
          ".T.\n");
  shape = shape.rotateRight();
  equal(shape.toString(), "" +
          ".T.\n" +
          "TT.\n" +
          ".T.\n");
});

test("can be rotated left 3 times", function() {
  shape = shape.rotateLeft();
  equal(shape.toString(), "" +
          ".T.\n" +
          "TT.\n" +
          ".T.\n");
  shape = shape.rotateLeft();
  equal(shape.toString(), "" +
          "...\n" +
          "TTT\n" +
          ".T.\n");
  shape = shape.rotateLeft();
  equal(shape.toString(), "" +
          ".T.\n" +
          ".TT\n" +
          ".T.\n");
});

test("rotating it 4 times will go back to the original shape", function() {
  var originalShape = shape.toString();
  shape = shape.rotateRight().rotateRight().rotateRight().rotateRight();
  equal(shape.toString(), originalShape);
  shape = shape.rotateLeft().rotateLeft().rotateLeft().rotateLeft();
  equal(shape.toString(), originalShape);
});

module("The I shape", {
  setup: function() {
    shape = new Tetromino("I");
  }
});

test("is shaped like I", function() {
  equal(shape.toString(), "" +
          "....\n" +
          "IIII\n" +
          "....\n" +
          "....\n");
});

test("can be rotated right once", function() {
  shape = shape.rotateRight();
  equal(shape.toString(), "" +
          "..I.\n" +
          "..I.\n" +
          "..I.\n" +
          "..I.\n");
});

test("can be rotated left once", function() {
  shape = shape.rotateLeft();
  equal(shape.toString(), "" +
          ".I..\n" +
          ".I..\n" +
          ".I..\n" +
          ".I..\n");
});

test("rotating it twice left will drop it down one line", function() {
  var expectedShape = "" +
          "....\n" +
          "....\n" +
          "IIII\n" +
          "....\n";
  shape = shape.rotateLeft().rotateLeft();
  equal(shape.toString(), expectedShape);
});

test("rotating it twice right will drop it down one line", function() {
  var expectedShape = "" +
          "....\n" +
          "....\n" +
          "IIII\n" +
          "....\n";
  shape = shape.rotateRight().rotateRight();
  equal(shape.toString(), expectedShape);
});

test("rotating it 4 times left will bring back the original shape", function() {
  var originalShape = shape.toString();
  shape = shape.rotateLeft().rotateLeft().rotateLeft().rotateLeft();
  equal(shape.toString(), originalShape);
});

test("rotating it 4 times right will bring back the original shape", function() {
  var originalShape = shape.toString();
  shape = shape.rotateRight().rotateRight().rotateRight().rotateRight();
  equal(shape.toString(), originalShape);
});


module("The O shape", {
  setup: function() {
    shape = new Tetromino("O");
  }
});

test("is shaped like O", function() {
  equal(shape.toString(), "" +
          "OO\n" +
          "OO\n");
});

test("can not be rotated right", function() {
  shape = shape.rotateRight();
  equal(shape.toString(), "" +
          "OO\n" +
          "OO\n");
});

test("can not be rotated left", function() {
  shape = shape.rotateLeft();
  equal(shape.toString(), "" +
          "OO\n" +
          "OO\n");
});

module("The S shape", {
  setup: function() {
    shape = new Tetromino("S");
  }
});

test("is shaped like S", function() {
  equal(shape.toString(), "" +
          ".SS\n" +
          "SS.\n" +
          "...\n");
});

test("can be rotated right 3 times", function() {
  shape = shape.rotateRight();
  equal(shape.toString(), "" +
          ".S.\n" +
          ".SS\n" +
          "..S\n");
  shape = shape.rotateRight();
  equal(shape.toString(), "" +
          "...\n" +
          ".SS\n" +
          "SS.\n");
  shape = shape.rotateRight();
  equal(shape.toString(), "" +
          "S..\n" +
          "SS.\n" +
          ".S.\n");
});

test("rotating it 4 times will go back to the original shape", function() {
  var originalShape = shape.toString();
  shape = shape.rotateRight().rotateRight().rotateRight().rotateRight();
  equal(shape.toString(), originalShape);
  shape = shape.rotateLeft().rotateLeft().rotateLeft().rotateLeft();
  equal(shape.toString(), originalShape);
});

module("The Z shape", {
  setup: function() {
    shape = new Tetromino("Z");
  }
});

test("is shaped like Z", function() {
  equal(shape.toString(), "" +
          "ZZ.\n" +
          ".ZZ\n" +
          "...\n");
});

test("can be rotated right 3 times", function() {
  shape = shape.rotateRight();
  equal(shape.toString(), "" +
          "..Z\n" +
          ".ZZ\n" +
          ".Z.\n");
  shape = shape.rotateRight();
  equal(shape.toString(), "" +
          "...\n" +
          "ZZ.\n" +
          ".ZZ\n");
  shape = shape.rotateRight();
  equal(shape.toString(), "" +
          ".Z.\n" +
          "ZZ.\n" +
          "Z..\n");
});

test("rotating it 4 times will go back to the original shape", function() {
  var originalShape = shape.toString();
  shape = shape.rotateRight().rotateRight().rotateRight().rotateRight();
  equal(shape.toString(), originalShape);
  shape = shape.rotateLeft().rotateLeft().rotateLeft().rotateLeft();
  equal(shape.toString(), originalShape);
});

module("The J shape", {
  setup: function() {
    shape = new Tetromino("J");
  }
});

test("is shaped like J", function() {
  equal(shape.toString(), "" +
          "J..\n" +
          "JJJ\n" +
          "...\n");
});

test("can be rotated right 3 times", function() {
  shape = shape.rotateRight();
  equal(shape.toString(), "" +
          ".JJ\n" +
          ".J.\n" +
          ".J.\n");
  shape = shape.rotateRight();
  equal(shape.toString(), "" +
          "...\n" +
          "JJJ\n" +
          "..J\n");
  shape = shape.rotateRight();
  equal(shape.toString(), "" +
          ".J.\n" +
          ".J.\n" +
          "JJ.\n");
});

test("rotating it 4 times will go back to the original shape", function() {
  var originalShape = shape.toString();
  shape = shape.rotateRight().rotateRight().rotateRight().rotateRight();
  equal(shape.toString(), originalShape);
  shape = shape.rotateLeft().rotateLeft().rotateLeft().rotateLeft();
  equal(shape.toString(), originalShape);
});

module("The L shape", {
  setup: function() {
    shape = new Tetromino("L");
  }
});

test("is shaped like L", function() {
  equal(shape.toString(), "" +
          "..L\n" +
          "LLL\n" +
          "...\n");
});

test("can be rotated right 3 times", function() {
  shape = shape.rotateRight();
  equal(shape.toString(), "" +
          ".L.\n" +
          ".L.\n" +
          ".LL\n");
  shape = shape.rotateRight();
  equal(shape.toString(), "" +
          "...\n" +
          "LLL\n" +
          "L..\n");
  shape = shape.rotateRight();
  equal(shape.toString(), "" +
          "LL.\n" +
          ".L.\n" +
          ".L.\n");
});

test("rotating it 4 times will go back to the original shape", function() {
  var originalShape = shape.toString();
  shape = shape.rotateRight().rotateRight().rotateRight().rotateRight();
  equal(shape.toString(), originalShape);
  shape = shape.rotateLeft().rotateLeft().rotateLeft().rotateLeft();
  equal(shape.toString(), originalShape);
});

</script>
</html> 
